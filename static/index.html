<!DOCTYPE html>
<html>
<header>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.0/css/bootstrap.min.css" />
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.0/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="/socket.io/socket.io.js"></script>
</header>
<style>
  .pdfobject-container { height: 4in; width:6in; border: 1rem solid rgba(0,0,0,.1); }
</style>

<body>
  <div>hello!</div>
  <textarea style="font-family:monospace;" id="input" rows="10" cols="100"></textarea>
  <button id='submit'>submit</button>
  <div id="output"></div>
  <img class="img-fluid" id="image"></img>
  <audio controls id="audio"></audio>
</body>
<script type="text/javascript">
  console.log('hello');

  var objectSocket = io.connect('http://localhost:8080/');
  var strIdent = '';
  objectSocket.on('hello', function(objectData) {
    strIdent = objectData.strIdent;
  });

  console.log('connected with id ' + strIdent);

  $('#submit').on('click', function() {
    objectSocket.emit('gen', {
      'gabc': $('#input').val()
    })
  });

  objectSocket.on('audio', function(data) {
    $("#audio").attr("src", "");
    $("#audio").attr("src", objectSocket.io.engine.id + "/test.wav");
  });
  objectSocket.on('image', function(data) {
    console.log('success! embedding image...');
    $("#image").attr("src", objectSocket.io.engine.id + "/test.png");
    // PDFObject.embed(objectSocket.io.engine.id + '/test.pdf', "#output", );
  });
  objectSocket.on('error', function(data) {
    $('#output').text('Error:\n' + data.log);
  });

  $(document).ready(function() {
    $('#input').load('example.gabc');
  });
</script>

</html>
