<!DOCTYPE html>
<html>
<header>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.js"></script>
  <script type="text/javascript" src="/socket.io/socket.io.js"></script>
</header>
<style>
  .pdfobject-container { height: 4in; width:6in; border: 1rem solid rgba(0,0,0,.1); }
</style>

<body>
  <div>hello!</div>
  <textarea id="input" rows="10" cols="100"></textarea>
  <button id='submit'>submit</button>
  <div id="output"></div>
</body>
<script type="text/javascript">
  console.log('hello');

  var objectSocket = io.connect('http://localhost:8080/');
  var strIdent = '';
  objectSocket.on('hello', function(objectData) {
    strIdent = objectData.strIdent;
  });

  console.log('connected with id ' + strIdent);

  $('#submit').on('click', function() {
    objectSocket.emit('message', {
      'gabc': $('#input').val()
    })
  });

  objectSocket.on('message', function(data) {
    if (data.status === 'done') {
      console.log('success! embedding pdf...');
      PDFObject.embed(objectSocket.io.engine.id + '/test.pdf', "#output", );
    } else {
      $('#output').text('Error:\n' + data.log);
    }
  });

  $(document).ready(function() {
    $('#input').load('example.gabc');
  });
</script>

</html>
